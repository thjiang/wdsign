Vue.filter("formatTelNo",function(e){if(e){if(e.indexOf("-")!==-1){return e}var b=e.split("");var d=[];var a=b.length;for(var c=0;c<a;c++){d.push(b[c]);if((c===2||((c-2)%4===0))&&c!==(a-1)){d.push("-")}}return d.join("")}});Vue.filter("formatColor",{read:function(a){return a.toUpperCase()},write:function(d,c){if(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(d)){var a=d.length;var e="";if(a==4){var b=d.split("").splice(1);e=b.map(function(f){return f+f});return"#"+e.join("").toUpperCase()}return d.toUpperCase()}else{return d}}});Vue.directive("validate",{update:function(b){if(b.hasOwnProperty("color")){var a=this.el;if(!/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(b.color)){console.log(b.color);a.classList.add("error")}else{if(a.classList.contains("error")){a.classList.remove("error")}}}}});var sign=new Vue({el:"#app",data:{info:{e_name:"",c_name:"",group:"",contact:{qq:"",add:"杭州市西湖区紫霞街80号西溪谷G座",e_mail:"@weidian.com",mobile:""}},style:{logo:"",co_title:"#000000",co_item:"#999999",co_icon:"#648fe7",co_bg:"#f6f7f7",co_line:"#000050"},cropper:null,flag:{isPC:false,showBowserUnsupport:false,needLoadSign:true,showColorSetting:false,imgHasLoad:false,cropperHasInit:false,previewHasCreate:false},img:null,helper:{support:!!(window.FileReader&&window.CanvasRenderingContext2D&&(window.URL||window.webkitURL)),isImage:function(b){var a=/^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;return !!(a.test(b))}}},ready:function(){this.checkIfPC();this.checkIfChrome();this.bindLoadImgEvent()},methods:{checkIfPC:function(){var c=this;var a=null;var b=function(){c.flag.isPC=screen.width<=600?true:false;return};b();window.addEventListener("resize",function(){if(a){clearTimeout(a)}a=setTimeout(b,300)})},resetColors:function(){var a=this;a.style={co_title:"#000000",co_item:"#999999",co_icon:"#648fe7",co_bg:"#F6F7F7",co_line:"#000050"}},checkIfChrome:function(){var c=this;var d=/chrome\/[\d.]+/gi;var b=navigator.userAgent.match(d);if(b){var a=(b+"").replace(/[^0-9.]/ig,"").split(".")[0];if(parseInt(a,10)>=49){c.flag.showBowserUnsupport=false;return}}c.flag.showBowserUnsupport=true},bindLoadImgEvent:function(){var h=this;if(!h.helper.support){return}var f=document.getElementById("uploadPreview");var e=document.querySelectorAll(".J_uploadImage");var g=new FileReader();var b=window.URL||window.webkitURL;var d;var a=e.length;for(var c=0;c<a;c++){e[c].addEventListener("change",function(){var j=this.files;if(j.length===0){return}var i=j[0];if(!h.helper.isImage(i.type)){alert("you have to select an image file!");return}g.readAsDataURL(i);d=b.createObjectURL(i);if(h.cropper){h.cropper.reset()}h.flag.imgHasLoad=true;h.img=this.dataset.dest})}g.onload=function(i){f.src=i.target.result;if(!h.flag.cropperHasInit){h.loadCropper();return}h.cropper.replace(d)}},loadCropper:function(){var d=this;var c=document.querySelector("#cropperBox > img");var e=document.getElementById("cropperRes");var a=e.getElementsByTagName("img").item(0);var b={aspectRatio:1/1,build:function(){a.src=c.src},crop:function(j){var i=this.cropper;var k=i.getImageData();var h=j.width/j.height;var g=e.offsetWidth;var f=g/h;var l=j.width/g;e.style.height=f+"px";a.style.width=k.naturalWidth/l+"px";a.style.height=k.naturalHeight/l+"px";a.style.marginLeft=-j.x/l+"px";a.style.marginTop=-j.y/l+"px"}};d.cropper=new Cropper(c,b);d.flag.cropperHasInit=true},finishCropImage:function(){var d=this;var b=d.cropper.getCroppedCanvas({width:200,height:200});var c=b.toDataURL();var a=".o2_sign ."+d.img+" img";document.querySelector(a).src=c;d.flag.imgHasLoad=false},downloadRes:function(){var c=this;var a=document.getElementById("sign");var b=this.info.e_name;domtoimage.toBlob(a).then(function(d){window.saveAs(d,b+".png")})}}});
